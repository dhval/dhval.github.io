<!DOCTYPE html>
<html>

<head>
    <title>iptables - usage – Dhval Mudawal – Rants</title>
    <meta charset="utf-8" />
<meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
<meta http-equiv='X-UA-Compatible' content='IE=edge'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'> 
<meta name="description" content="Here are some frequent iptables usage notes." />
<meta property="og:description" content="Here are some frequent iptables usage notes." /> 
<meta name="author" content="Dhval Mudawal" /> 
<meta property="og:title" content="iptables - usage" />
<meta property="twitter:title" content="iptables - usage" /> 
    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- Twitter Bootstrap css -->
    <link href="/css/font-awesome.min.css">
    <link href="/dist/bootstrap/css/bootstrap.css" rel="stylesheet">
    <!-- Your css -->
    <link href="/css/base-war.css" rel="stylesheet">
    <link href="/css/dhval.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/responsive.css" rel="stylesheet">
    <!-- Vendor js -->
    <script type="text/javascript" charset="utf-8" src="/dist/requirejs/require.js"></script>
    <script type="text/javascript" charset="utf-8" src="/dist/modernizr/modernizr.js"></script>
    <!-- Your js -->
    <script type="text/javascript" charset="utf-8" src="/js/require.config.js"></script>
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Dhval Mudawal - Rants" href="/feed.xml" />
</head>

<body>
    <div class="wrapper-masthead">
    <div class="container">
        <header class="masthead clearfix">
            <a href="/" class="site-avatar"><img class="img-thumbnail" src="https://raw.githubusercontent.com/barryclark/jekyll-now/master/images/jekyll-logo.png" /></a>
            <div class="site-info">
                <h1 class="site-name"><a href="/">Dhval Mudawal</a></h1>
                <p class="site-description">
                     iptables - usage 
                     | Updated: August 23, 2015
                    
                </p>
            </div>
            <nav>
                <a href="/">Home</a>
                <a href="/about">About</a>
            </nav>
        </header>
    </div>
</div>
    <div id="main" role="main" class="container">
        <article class="post">
  <div class="date">
	 <a href="https://www.evernote.com/shard/s11/sh/c611615b-fbc6-4baa-aed7-24b816c53a55/2b8ec6b77957225f4d0f00dca3af0240/">View on Evernote.com</a> 
  </div>

  <div class="entry">
    <p><en-note style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">
<div style="font-size:100%;vertical-align:baseline;">
<div style="vertical-align: baseline; text-align: center; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-image: url(http://cdn.sstatic.net/unix/img/bg-site.png?v=92eb02dd2e07); background-color: transparent; background-position: 50% 0%; background-repeat: repeat repeat;">
<div style="vertical-align: baseline; text-align: left; zoom: 1;">
<div style="vertical-align: baseline; overflow: auto;">
<div style="vertical-align: baseline;">
<div style="vertical-align: baseline;">
<div style="vertical-align: baseline;">
<div style="vertical-align: baseline;">
<table style="font-weight: inherit; font-style: inherit; font-variant: inherit; vertical-align: baseline;">
<tbody style="vertical-align: baseline;">
<tr style="vertical-align: baseline;">
<td style="vertical-align: top;">
<div style="vertical-align: baseline; word-wrap: break-word;">
<div><span style="font-family: Arial;">Here are some frequent iptables usage notes.</span></div>
<div>
<div style="color: rgb(0, 0, 0);">
<pre style="padding: 5px 5px 5px 10px; border-width: 0px 0px 0px 5px; border-left-style: solid; border-left-color: rgb(204, 204, 204); vertical-align: baseline; overflow: auto; max-height: 600px; word-wrap: normal; background-color: rgb(238, 238, 238);">
 <span style="font-family: Arial;">iptables -nvL --line-numbers 
</span>
</pre></div>
<div style="color: rgb(0, 0, 0);">
<div style="color: rgb(51, 51, 51);"></div>
</div>
</div>
<ul style="color: rgb(0, 0, 0); padding: 0px; list-style: square; background-color: rgb(255, 255, 255);">
<li style="padding: 0px;"><span style="font-family: Arial;"><strong style="padding: 0px;">-L</strong><b> : </b>List rules.<b> --line-numbers</b> : Show rule number  <strong style="padding: 0px;">-v</strong> : Verbose.</span></li>
<li style="color: rgb(17, 17, 17); padding: 0px;"><span style="font-family: Arial;"><strong style="padding: 0px;">-n</strong> : Display IP address and port in numeric format. Do not use DNS to resolve names.</span></li>
<li style="color: rgb(17, 17, 17); padding: 0px;"><span style="font-family: Arial;"><strong style="padding: 0px;">-t</strong> : Show rules from table. e.g. -t nat, <span style="color: rgb(0, 0, 0); background-color: rgb(230, 230, 230);">By default iptables assumes the &#39;filter&#39; table.</span></span></li>
<li style="padding: 0px;"><span style="font-family: Arial;"><span style="color: rgb(17, 17, 17);"><strong style="padding: 0px;">-F</strong> : Flush rules.  </span><strong style="color: rgb(17, 17, 17); padding: 0px;">-P</strong><span style="color: rgb(17, 17, 17);"> : Default rule. </span><span style="color: rgb(17, 17, 17);"> </span><strong style="color: rgb(17, 17, 17); padding: 0px;">-X</strong><font color="#111111"> : Delete custom chain with no references.</font></span></li>
<li style="padding: 0px;"><span style="font-family: Arial;"><font color="#111111"><strong style="padding: 0px;">-A</strong> : APPEND   <strong style="padding: 0px;">-I</strong> : INSERT   <strong style="padding: 0px;">-D</strong> : Delete  <strong style="padding: 0px;">-R</strong> : Replace<br/></font></span></li>
<li style="color: rgb(17, 17, 17); padding: 0px;"><b><span style="font-family: Arial;"><br/></span></b></li>
<li style="color: rgb(17, 17, 17); padding: 0px;"><span style="font-family: Arial;"><strong style="padding: 0px;">--dport</strong> : destination-port. It&#39;s a flag for one of it&#39;s <em style="padding: 0px; border: 0px; vertical-align: baseline;">extended packet matching modules i.e</em>. used with <span style="font-size: 14px;"><code style="padding: 1px 5px; border: 0px; vertical-align: baseline; white-space: pre-wrap; background-color: rgb(238, 238, 238);"><span style="font-family: Arial;">-p protocol</span></code> or <code style="padding: 1px 5px; border: 0px; vertical-align: baseline; white-space: pre-wrap; background-color: rgb(238, 238, 238);"><span style="font-family: Arial;">-m</span></code>.</span></span></li>
</ul>
<div><span style="font-family: Arial;"><b><br/></b></span></div>
<div><span style="font-family: Arial;"><b>Define custom chain</b>.  </span></div>
<div><span style="font-family: Arial;"><span style="font-style: inherit; font-variant: inherit;"><br/></span></span></div>
<div><span style="font-family: Arial;"><span style="font-style: inherit; font-variant: inherit;">Add a chain </span><span style="font-size: 14px;"><code style="font-style: inherit; font-variant: inherit; margin: 0px; padding: 1px 5px; border: 0px; vertical-align: baseline; color: rgb(34, 34, 34); background-color: rgb(238, 238, 238); white-space: pre-wrap;"><span style="font-family: Arial;">LOGGING</span></code><span style="font-style: inherit; font-variant: inherit;">. </span><span style="font-style: inherit; font-variant: inherit;">Everything not being -d</span> <span style="font-style: inherit; font-variant: inherit;"> </span><code style="font-style: inherit; font-variant: inherit; margin: 0px; padding: 1px 5px; border: 0px; vertical-align: baseline; color: rgb(34, 34, 34); background-color: rgb(238, 238, 238); white-space: pre-wrap;"><span style="font-family: Arial;">127.0.0.0/8</span></code><span style="font-style: inherit; font-variant: inherit;"> or</span><span style="font-style: inherit; font-variant: inherit;"> </span><code style="font-style: inherit; font-variant: inherit; margin: 0px; padding: 1px 5px; border: 0px; vertical-align: baseline; color: rgb(34, 34, 34); background-color: rgb(238, 238, 238); white-space: pre-wrap;"><span style="font-family: Arial;">239.192.0.0/16</span></code><span style="font-style: inherit; font-variant: inherit;"> </span><span style="font-style: inherit; font-variant: inherit;">would be logged, then control would go back to the</span><span style="font-style: inherit; font-variant: inherit;"> </span><code style="font-style: inherit; font-variant: inherit; margin: 0px; padding: 1px 5px; border: 0px; vertical-align: baseline; color: rgb(34, 34, 34); background-color: rgb(238, 238, 238); white-space: pre-wrap;"><span style="font-family: Arial;">OUTPUT</span></code><span style="font-style: inherit; font-variant: inherit;">.</span></span></span></div>
<div><span style="font-family: Arial;"><span style="font-style: inherit; font-variant: inherit;">All packets coming through the</span><span style="font-style: inherit; font-variant: inherit;"> </span><span style="font-size: 14px;"><code style="font-style: inherit; font-variant: inherit; margin: 0px; padding: 1px 5px; border: 0px; vertical-align: baseline; color: rgb(34, 34, 34); background-color: rgb(238, 238, 238); white-space: pre-wrap;"><span style="font-family: Arial;">OUTPUT</span></code><span style="font-style: inherit; font-variant: inherit;"> </span><span style="font-style: inherit; font-variant: inherit;">chain would go through the</span><span style="font-style: inherit; font-variant: inherit;"> </span><code style="font-style: inherit; font-variant: inherit; margin: 0px; padding: 1px 5px; border: 0px; vertical-align: baseline; color: rgb(34, 34, 34); background-color: rgb(238, 238, 238); white-space: pre-wrap;"><span style="font-family: Arial;">LOGGING</span></code><span style="font-style: inherit; font-variant: inherit;"> </span><span style="font-style: inherit; font-variant: inherit;">chain.</span></span></span></div>
<div><span style="font-family: Arial;"><a href="evernote:///view/1235176/s11/c611615b-fbc6-4baa-aed7-24b816c53a55/c611615b-fbc6-4baa-aed7-24b816c53a55/" style="color:#69aa35;">iptables - examples</a></span></div>
<pre style="margin: 0px 0px 10px; padding: 5px; border: 0px; vertical-align: baseline; overflow: auto; width: auto; max-height: 600px; background-color: rgb(238, 238, 238); word-wrap: normal;">
<code style="margin: 0px; padding: 0px; border: 0px; vertical-align: baseline; background-color: rgb(238, 238, 238); white-space: inherit;">$<span style="color: rgb(34, 34, 34); font-size: 14px; font-family: Arial;"> iptables -N LOGGING
$ iptables -A LOGGING -d 127.0.0.0/8 -j RETURN
$ iptables -A LOGGING -d 239.192.0.0/16 -j RETURN
$ iptables -A LOGGING -j LOG 
$ iptables -A OUTPUT -j LOGGING </span></code><span style="font-size: 14px; font-family: Arial;">
</span>
</pre>
<div>
<div><span style="font-family: Arial;"><b><font style="color: rgb(0, 0, 0);">Use iprange module</font></b></span></div>
<div style="color: rgb(0, 0, 0);">
<pre style="padding: 5px 5px 5px 10px; border-width: 0px 0px 0px 5px; border-left-style: solid; border-left-color: rgb(204, 204, 204); vertical-align: baseline; overflow: auto; max-height: 600px; word-wrap: normal; background-color: rgb(238, 238, 238);">
<span style="font-family: Arial;"> iptables -t mangle -A LOGGING -p tcp -m iprange --dst-range 192.168.1.1-192.168.1.20 -j RETURN
</span>
</pre></div>
<div style="color: rgb(0, 0, 0);">
<div style="color: rgb(51, 51, 51);">
<div><span style="font-size: 14px;"><code style="padding: 0px; border: 0px; vertical-align: baseline; white-space: inherit;"><span style="font-family: Arial;"><b><font style="color: rgb(0, 0, 0);">Use iprange module</font></b></span></code></span></div>
<div style="color: rgb(0, 0, 0);">
<pre style="padding: 5px 5px 5px 10px; border-width: 0px 0px 0px 5px; border-left-style: solid; border-left-color: rgb(204, 204, 204); vertical-align: baseline; overflow: auto; max-height: 600px; word-wrap: normal; background-color: rgb(238, 238, 238);">
<code style="padding: 0px; border: 0px; vertical-align: baseline; white-space: inherit;"> <span style="font-size: 14px; font-family: Arial;">iptables -t mangle -A LOGGING -p tcp -m iprange --dst-range 192.168.1.1-192.168.1.20 -j RETURN </span></code><span style="font-size: 14px; font-family: Arial;">
</span>
</pre></div>
<div style="color: rgb(0, 0, 0);"></div>
</div>
<div style="color: rgb(51, 51, 51);"><span style="font-family: Arial;"><b><font style="color: rgb(0, 0, 0);">Use multi port with tcp / udp</font></b></span></div>
<div>
<pre style="padding: 5px 5px 5px 10px; border-width: 0px 0px 0px 5px; border-left-style: solid; border-left-color: rgb(204, 204, 204); vertical-align: baseline; overflow: auto; max-height: 600px; word-wrap: normal; background-color: rgb(238, 238, 238);">
<span style="font-family: Arial;"> -p tcp  --match multiport --sports 80,443 -j LOGGING
</span>
</pre>
<div>
<div style="color: rgb(51, 51, 51);"><span style="font-family: Arial;"><b><font style="color: rgb(0, 0, 0);">Logging with limit module</font></b></span></div>
<div>
<pre style="padding: 5px 5px 5px 10px; border-width: 0px 0px 0px 5px; border-left-style: solid; border-left-color: rgb(204, 204, 204); vertical-align: baseline; overflow: auto; max-height: 600px; word-wrap: normal; background-color: rgb(238, 238, 238);">
<span style="font-family: Arial;"> -m limit --limit 3/min -j LOG --log-prefix &quot;iptables denied: &quot; --log-level 4
</span>
</pre></div>
</div>
<div>
<div style="color: rgb(51, 51, 51);"><span style="font-family: Arial;"><b><font style="color: rgb(0, 0, 0);">State &amp; MAC ADDRESS</font></b></span></div>
<div>
<pre style="padding: 5px 5px 5px 10px; border-width: 0px 0px 0px 5px; border-left-style: solid; border-left-color: rgb(204, 204, 204); vertical-align: baseline; overflow: auto; max-height: 600px; word-wrap: normal; background-color: rgb(238, 238, 238);">
<span style="font-family: Arial;"> -m state --state NEW -m mac --mac-source YOUR-MAC-ADDRESS-HERE
</span>
</pre></div>
</div>
<div>
<div style="color: rgb(51, 51, 51);"><span style="font-family: Arial;"><b><font style="color: rgb(0, 0, 0);">Use iprange module</font></b></span></div>
<div>
<pre style="padding: 5px 5px 5px 10px; border-width: 0px 0px 0px 5px; border-left-style: solid; border-left-color: rgb(204, 204, 204); vertical-align: baseline; overflow: auto; max-height: 600px; word-wrap: normal; background-color: rgb(238, 238, 238);">
<span style="font-family: Arial;"> iptables -t mangle -A LOGGING -p tcp -m iprange --dst-range 192.168.1.1-192.168.1.20 -j RETURN
</span>
</pre></div>
</div>
<div><span style="font-family: Arial;"><br/></span></div>
</div>
</div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div><span style="color: rgb(17, 17, 17);"><b><span style="font-size: 14px;"><span style="font-family: Arial;"># References iptables</span></span></b></span></div>
<div style="box-sizing: border-box;">
<div style="box-sizing: border-box;">
<div style="box-sizing: border-box;">
<div style="box-sizing: border-box;">
<div style="box-sizing: border-box;">
<div style="box-sizing: border-box;">
<div style="box-sizing: border-box;">
<div style="box-sizing: border-box;">
<div style="box-sizing: border-box;">
<div style="box-sizing: border-box; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;">
<div style="box-sizing: border-box; overflow-x: auto; overflow-y: hidden;">
<div style="box-sizing: border-box;">
<div style="box-sizing: border-box; overflow: hidden; word-wrap: break-word;">
<div>
<h3 style="padding: 0px; color: rgb(17, 17, 17); background-color: rgb(255, 255, 255);"><span style="font-size: 14px;"><span style="font-family: Arial;"><a href="http://www.thegeekstuff.com/2012/08/iptables-log-packets/"><font style="font-weight: normal;">http://www.thegeekstuff.com/2012/08/iptables-log-packets/</font></a></span></span></h3>
<h3 style="padding: 0px; color: rgb(17, 17, 17); background-color: rgb(255, 255, 255);"><span style="font-size: 14px;"><span style="font-family: Arial;"><a href="http://www.thegeekstuff.com/scripts/iptables-rules" style="font-weight: normal;">http://www.thegeekstuff.com/scripts/iptables-rules</a></span></span></h3>
<div>
<h3 style="padding: 0px; color: rgb(17, 17, 17); background-color: rgb(255, 255, 255);"><span style="font-size: 14px;"><span style="font-family: Arial;"><a href="http://crm.vpscheap.net/knowledgebase.php?action=displayarticle&amp;id=29"><font style="font-weight: normal;">http://crm.vpscheap.net/knowledgebase.php?action=displayarticle&amp;id=29</font></a></span></span></h3>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div>
<div><span style="font-family: Arial;"><a href="https://wiki.archlinux.org/index.php/iptables">https://wiki.archlinux.org/index.php/iptables</a></span></div>
<div><span style="font-family: Arial;"><br/></span></div>
<div><span style="font-family: Arial;"><a href="http://artoflinux.blogspot.com/2008/07/iptables-tutorial-for-beginners.html">http://artoflinux.blogspot.com/2008/07/iptables-tutorial-for-beginners.html</a></span></div>
<div><span style="font-family: Arial;"><br/></span></div>
<div><span style="font-family: Arial;"><a href="http://www.cyberciti.biz/faq/rhel-fedorta-linux-iptables-firewall-configuration-tutorial/">http://www.cyberciti.biz/faq/rhel-fedorta-linux-iptables-firewall-configuration-tutorial/</a></span></div>
<div><span style="font-family: Arial;"><br/></span></div>
<div><span style="font-family: Arial;"><a href="http://www.netfilter.org/documentation/HOWTO/packet-filtering-HOWTO-7.html">http://www.netfilter.org/documentation/HOWTO/packet-filtering-HOWTO-7.html</a></span></div>
<div><span style="font-family: Arial;"><br/></span></div>
<div><span style="font-family: Arial;">Rate Limiting</span></div>
<div><span style="font-family: Arial;"><br/></span></div>
<div><span style="font-family: Arial;"><a href="http://serverfault.com/questions/384132/iptables-limit-rate-of-a-specific-incoming-ip">http://serverfault.com/questions/384132/iptables-limit-rate-of-a-specific-incoming-ip</a></span></div>
<div><span style="font-family: Arial;"><a href="http://courses.oreillyschool.com/sysadmin5/IPTables_Speed_Limits.html">http://courses.oreillyschool.com/sysadmin5/IPTables<em>Speed</em>Limits.html</a></span></div>
</div>
</en-note></p>

  </div>

  
</article>

    </div>
    <div class="wrapper-footer">
    <div class="container">
        <footer class="footer">
            

<a href="http://facebook.com/dhval.mudawal"><i class="svg-icon facebook"></i></a>

<a href="http://github.com/dhval"><i class="svg-icon github"></i></a>

<a href="http://linkedin.com/in/dhvalmudawal"><i class="svg-icon linkedin"></i></a>


<a href="http://twitter.com/jekyllrb"><i class="svg-icon twitter"></i></a>


        </footer>
    </div>
    <p style="text-align:center;">© I do not claim ownership of this content. Please send me a <a href="/suggestions">message</a>, if this infringes any copyright. </p>
</div>
</body>

</html>